

<!DOCTYPE html>
<html lang="en">
<head>
<title>Create a Mix Task for an Elixir Project - Joe Yates' Blog</title>
<meta content="The steps necessary to implement a Mix task, and see its documentation" name="description">
<meta content="width=device-width" name="viewport">
<link href="/sitemap.xml" rel="sitemap" title="Sitemap" type="application/xml">
<link href="/assets/app-cb475e5b8a234b2a45f4bc6cceeb180c.css" media="all" rel="stylesheet">
<script defer="true" src="/assets/application-04330b44b64bd6872cdc831811bd0720.js" type="text/javascript"></script>
</head>
<body class="font-sans text-xl bg-olive flex justify-center">
<div class="max-w-full min-h-screen md:w-[40rem] bg-light-olive py-4 px-10 flex flex-col">
<header>
<nav>
<ul class="flex list-none">
<li class="mr-8">
<a href="/">Home</a></li>
<li class="mr-8">
<a href="/posts/">Archives</a></li>
<li>
<a href="/categories/">Categories</a></li></ul></nav>
<div class="prose">
<h1>
Create a Mix Task for an Elixir Project</h1></div></header>

<main class="max-w-full grow mx-1">

<section class="space-y-4 prose">
<div class="flex justify-end mb-4">
<div>2015/07/25</div>
</div>
<h2 class="text-lg">
The steps necessary to implement a Mix task, and see its documentation
</h2>
<p>Mix tasks are helper tasks in Elixir projects.</p><p>In this post, I'll create an empty project and a "Hello World!"</p><p>I can create a new project with</p><pre title="language: shell"><code class="language-shell">$ mix new mix_task_example</code></pre><p>Now, inside the new `mix_task_example` project directory, running</p><pre title="language: shell"><code class="language-shell">$ mix help</code></pre><p>shows which mix tasks are available and in this newly created project there are already more than 30.</p><p>Now I create the directory for tasks with</p><pre title="language: shell"><code class="language-shell">$ mkdir -p lib/mix/tasks</code></pre><p>and create a file with the name of the task, e.g. <code>mix_task_example.salute.ex</code></p><p>with the following contents:</p><div class="text-sm text-gray-500 mb-0">lib/mix/tasks/mix_task_example.salute.ex:</div><pre title="language: elixir"><code class="language-elixir">defmodule Mix.Tasks.MixTaskExample.Salute do
  use Mix.Task

  def run(_) do
    IO.puts "Hello World!"
  end
end</code></pre><p>This far, the task is not yet available, I need to compile the project</p><pre title="language: shell"><code class="language-shell">$ mix compile</code></pre><p>And now I can run it with</p><pre title="language: shell"><code class="language-shell">$ mix mix_task_example.salute
Hello World!</code></pre><p>The task doesn't show up in the listing with <code>mix help</code>.</p><p>To make it show up I need to add <code>@shortdoc</code></p><div class="text-sm text-gray-500 mb-0">lib/mix/tasks/mix_task_example.salute.ex:</div><pre title="language: elixir"><code class="language-elixir">defmodule Mix.Tasks.MixTaskExample.Salute do
  use Mix.Task

  @shortdoc "Give a short salutation"
  def run(_) do
    IO.puts "Hello World!"
  end
end</code></pre><p>If the tasks are part of a library, they will be available to project that include it as a dependency, so it's important to use the library name (e.g. <code>MixTaskExample</code>) in the module name in order to keep tasks in a collective namespace.</p><p>As a final touch, let's accept a parameter</p><div class="text-sm text-gray-500 mb-0">lib/mix/tasks/mix_task_example.salute.ex:</div><pre title="language: shell"><code class="language-shell">defmodule Mix.Tasks.MixTaskExample.Salute do
  use Mix.Task

  @shortdoc "Give a short salutation"
  def run(name) do
    IO.puts "Hello #{name}!"
  end
end</code></pre><pre title="language: shell"><code class="language-shell">$ mix compile
$ mix mix_task_example.salute Joe
Hello Joe!</code></pre><p>A working mix task!</p><p>The code for this example can be found at <a href="https://github.com/joeyates/mix_task_example" target="_blank">https://github.com/joeyates/mix_task_example</a></p>
</section>
<ul class="paginate">
<li>

<a href="/posts/trying-flow/">← Newer</a></li>
<li>

<a href="/posts/how-to-forward-blocks-in-ruby/">Older →</a></li></ul>
</main>
<footer class="bottom-0 mt-6">
<hr class="mb-4">

<div class="flex flex-row justify-between text-sm">
<div>
<span>Made with</span>
<a href="https://github.com/joeyates/fermo">Fermo</a>
</div>
<p>&copy; Joe Yates 2015</p>
</div></footer>
</div></body></html>
